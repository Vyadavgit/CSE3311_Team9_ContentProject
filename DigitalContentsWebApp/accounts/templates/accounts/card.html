{% extends 'accounts/main.html' %}
{% load static %}

{% block content %}
<!-- Rendering card and performing client side validation by using following js code provided by stripe-->
<script src="https://js.stripe.com/v3/"></script>
<script src="{% static '/js/card.js' %}"></script>
<!-- using above library to define card function that will render the card and validate it-->
<script>
  card('{{STRIPE_PUBLISHABLE_KEY}}', '{{customer_email}}');
</script>


    <div class="row py-3">
        <div class="col-lg-12 col-md-12">
           <div class="container">
            <form action="{% url 'card' %}" method="post" id="payment-form">
              {% csrf_token %}
              <div id="card-element">
                <!-- Elements will create input elements here -->
                   <!-- A Stripe Element will be inserted here. -->
              </div>
              <!-- Used to display form errors. -->
              <div id="card-errors" role="alert"></div>
                <br>
              <!-- Payment Intent requires a payment method. Set an existing payment method on the PaymentIntent -->
              <!-- Adding hidden element with name PIid and with value PIid so
               when form is submitted, this PIid along with PaymentMethod id will be passed to next view which is "card".
               Only payment flow has been initiated and there is no payment yet -->
              <input type="hidden" name="payment_intent_id" value="{{ payment_intent_id }}" >
                <!-- creating hidden input elements -->
              <input type="hidden" name="stripe_plan_id" value="{{ stripe_plan_id }}" >
              <input type="hidden" name="automatic" value="{{ automatic }}" >

              <button id="submit-button">Pay</button>
            </form>
           </div>
        </div>
    </div>
{% endblock content %}